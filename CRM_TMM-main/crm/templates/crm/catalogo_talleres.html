{% extends 'crm/base.html' %}
{% load humanize %}

{% block content %}
    
    <h1>Catálogo de Talleres Disponibles</h1>
    <p>
        ¡Elige el taller que más te interese y planifica tu participación! 
        Aquí encuentras todas las opciones de manualidades y creatividad que TMM Bienestar y Conexión tiene para ti.
    </p>

    <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
        
        {% for taller in talleres %}
        <div class="taller-card" style="border: 1px solid #ccc; padding: 15px; width: 300px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); background-color: white;">
            
            {% if taller.imagen %}
                <img src="{{ taller.imagen.url }}" alt="Imagen del Taller {{ taller.nombre }}" 
                     style="width: 100%; height: 166px; object-fit: cover; margin-bottom: 10px; border-radius: 6px;">
            {% else %}
                <div style="width: 100%; height: 180px; background-color: #f3e5f5; text-align: center; line-height: 180px; margin-bottom: 10px; border-radius: 6px; color: #9c27b0;">
                    
                </div>
            {% endif %}
            
            <h3 style="color: #9c27b0; border-bottom: 2px solid #e91e63; padding-bottom: 5px;">{{ taller.nombre }}</h3>
            
            <p><strong>Fecha:</strong> {{ taller.fecha_taller|date:"d-m-Y" }}</p>
            <p><strong>Modalidad:</strong> {{ taller.get_modalidad_display }}</p>
            
            <p><strong>Precio:</strong> ${{ taller.precio|floatformat:0 }} CLP</p>
            
            <p>
                <strong>Cupos:</strong> 
                {% if taller.cupos_disponibles > 0 %}
                    <span style="color: green; font-weight: bold;">{{ taller.cupos_disponibles }} disponibles</span>
                {% else %}
                    <span style="color: red; font-weight: bold;">¡Agotado!</span>
                {% endif %}
            </p>
            
            <a href="{% url 'detalle_taller' taller_id=taller.id %}" style="font-weight: 500; display: block; text-align: center; background-color: #e91e63; color: white; padding: 10px; text-decoration: none; border-radius: 4px; margin-top: 10px;">
                Ver Detalles e Inscribirme
            </a>
            
        </div>
        {% empty %}
        <p>En este momento, no tenemos talleres disponibles. ¡Vuelve pronto!</p>
        {% endfor %}
        
    </div>

{% endblock content %}